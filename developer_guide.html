<!DOCTYPE html>

<html data-content_root="./" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/><meta content="width=device-width, initial-scale=1" name="viewport"/>
<title>Developer Guide — Toolbox 0.0.0a documentation</title>
<link href="_static/pygments.css?v=d75fae25" rel="stylesheet" type="text/css"/>
<link href="_static/groundwork.css?v=594d7a89" rel="stylesheet" type="text/css"/>
<link href="_static/copybutton.css?v=76b2166b" rel="stylesheet" type="text/css"/>
<link href="_static/sphinx-codeautolink.css?v=b2176991" rel="stylesheet" type="text/css"/>
<link href="_static/sphinx-design.min.css?v=95c83b7e" rel="stylesheet" type="text/css"/>
<script src="_static/documentation_options.js?v=e8454e50"></script>
<script src="_static/doctools.js?v=9bcbadda"></script>
<script src="_static/sphinx_highlight.js?v=dc90522c"></script>
<script src="_static/clipboard.min.js?v=a7894cd8"></script>
<script src="_static/copybutton.js?v=df1a032d"></script>
<script src="_static/design-tabs.js?v=f930bc37"></script>
<script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
<link href="https://noc-obg-autonomy.github.io/toolbox/developer_guide.html" rel="canonical"/>
<link href="genindex.html" rel="index" title="Index"/>
<link href="search.html" rel="search" title="Search"/>
<link href="index.html" rel="prev" title="Toolbox Documentation"/>
</head><body>
<div aria-label="Related" class="related" role="navigation">
<h3>Navigation</h3>
<ul>
<li class="right" style="margin-right: 10px">
<a accesskey="I" href="genindex.html" title="General Index">index</a></li>
<li class="right">
<a accesskey="P" href="index.html" title="Toolbox Documentation">previous</a> |</li>
<li class="nav-item nav-item-0"><a href="index.html">Toolbox 0.0.0a documentation</a> »</li>
<li class="nav-item nav-item-this"><a href="">Developer Guide</a></li>
</ul>
</div>
<div class="document">
<div class="documentwrapper">
<div class="bodywrapper">
<div class="body" role="main">
<section id="developer-guide">
<h1>Developer Guide<a class="headerlink" href="#developer-guide" title="Link to this heading">¶</a></h1>
<p>This page explains how to add a new <strong>step</strong> to the Toolbox (e.g., a new
processing stage, validation routine, or export).</p>
<section id="what-is-a-step">
<h2>What is a “step”?<a class="headerlink" href="#what-is-a-step" title="Link to this heading">¶</a></h2>
<p>A step is a stage in the pipeline that can be defined via Python, and configured via the Pipelines Config file. Examples of steps include:</p>
<ul class="simple">
<li><p>I/O Steps (e.g., reading from a <a class="reference external" href="https://noc-obg-autonomy.github.io/toolbox/api/toolbox/steps/custom/load_data/index.html">load_data.py</a>, containing <code class="docutils literal notranslate"><span class="pre">Load</span> <span class="pre">OG1</span></code>, or <code class="docutils literal notranslate"><span class="pre">export.py</span></code>, containing <code class="docutils literal notranslate"><span class="pre">Data</span> <span class="pre">Export</span></code>)</p></li>
<li><p>Variable Processing Steps (e.g., <a class="reference external" href="https://noc-obg-autonomy.github.io/toolbox/api/toolbox/steps/custom/variables/salinity/index.html">salinity.py</a>, containing <code class="docutils literal notranslate"><span class="pre">QC:</span> <span class="pre">Salinity</span></code> and <code class="docutils literal notranslate"><span class="pre">ADJ:</span> <span class="pre">Salinity</span></code>)</p></li>
<li><p>Data Processing Steps (e.g., <a class="reference external" href="https://noc-obg-autonomy.github.io/toolbox/api/toolbox/steps/custom/derive_ctd/index.html">derive_ctd.py</a>, containing <code class="docutils literal notranslate"><span class="pre">Find</span> <span class="pre">Profiles</span></code>)</p></li>
</ul>
<p>Steps are not limited to one per file - in fact, a single file can contain multiple steps. For example, the <a class="reference external" href="https://noc-obg-autonomy.github.io/toolbox/api/toolbox/steps/custom/variables/salinity/index.html">salinity.py</a> file contains both a QC and an ADJ step.</p>
</section>
<section id="how-to-add-a-new-step">
<h2>How to add a new step<a class="headerlink" href="#how-to-add-a-new-step" title="Link to this heading">¶</a></h2>
<ol class="arabic">
<li><p>Create a new Python file in the appropriate directory under <code class="docutils literal notranslate"><span class="pre">src/toolbox/steps/custom/</span></code>.<br/>
<strong>NOTE</strong>: if you are creating a step for specific vairables - such as a salinity QC step - then it should go in the <code class="docutils literal notranslate"><span class="pre">variables</span></code> subdirectory.</p></li>
<li><p>Define a new class for your step, inheriting from <code class="docutils literal notranslate"><span class="pre">BaseStep</span></code> (or another appropriate base class, such as <code class="docutils literal notranslate"><span class="pre">VariableStep</span></code> or <code class="docutils literal notranslate"><span class="pre">DataStep</span></code>).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span> <span class="kn">from</span><span class="w"> </span><span class="nn">toolbox.steps.base</span><span class="w"> </span><span class="kn">import</span> <span class="n">BaseStep</span>
 <span class="k">class</span><span class="w"> </span><span class="nc">MyNewStep</span><span class="p">(</span><span class="n">BaseStep</span><span class="p">):</span>
     <span class="o">...</span>
</pre></div>
</div>
</li>
<li><p>Define the step_name attribute, which is the name that will be used in the Pipelines Config file to refer to this step.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">toolbox.steps.base</span><span class="w"> </span><span class="kn">import</span> <span class="n">BaseStep</span>
 <span class="k">class</span><span class="w"> </span><span class="nc">MyNewStep</span><span class="p">(</span><span class="n">BaseStep</span><span class="p">):</span>
     <span class="n">step_name</span> <span class="o">=</span> <span class="s2">"My New Step"</span>
     <span class="o">...</span>
</pre></div>
</div>
</li>
<li><p>Register the step using the <code class="docutils literal notranslate"><span class="pre">@register_step</span></code> decorator.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span> <span class="kn">from</span><span class="w"> </span><span class="nn">toolbox.steps</span><span class="w"> </span><span class="kn">import</span> <span class="n">BaseStep</span><span class="p">,</span> <span class="n">register_step</span>
 <span class="nd">@register_step</span>
 <span class="k">class</span><span class="w"> </span><span class="nc">MyNewStep</span><span class="p">(</span><span class="n">BaseStep</span><span class="p">):</span>
     <span class="n">step_name</span> <span class="o">=</span> <span class="s2">"My New Step"</span>
     <span class="o">...</span>
</pre></div>
</div>
<p>This ensures that the step is discoverable by the Pipeline Manager, as well as allowing you do define other classes in the same file without registering them.</p>
</li>
<li><p>Implement the <code class="docutils literal notranslate"><span class="pre">run</span></code> method, which contains the logic for your step. This method should take no arguments other than <code class="docutils literal notranslate"><span class="pre">self</span></code>, and should return a <code class="docutils literal notranslate"><span class="pre">self.context</span></code> object.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">toolbox.steps.base</span><span class="w"> </span><span class="kn">import</span> <span class="n">BaseStep</span><span class="p">,</span> <span class="n">register_step</span>
<span class="nd">@register_step</span>
 <span class="k">class</span><span class="w"> </span><span class="nc">MyNewStep</span><span class="p">(</span><span class="n">BaseStep</span><span class="p">):</span>
     <span class="n">step_name</span> <span class="o">=</span> <span class="s2">"My New Step"</span>
     
     <span class="k">def</span><span class="w"> </span><span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
         <span class="c1"># Your processing logic here</span>
         <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span>        
</pre></div>
</div>
</li>
<li><p>Optionally, implement the <code class="docutils literal notranslate"><span class="pre">generate_diagnostics</span></code> method if your step produces any diagnostic plots or outputs.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">toolbox.steps.base</span><span class="w"> </span><span class="kn">import</span> <span class="n">BaseStep</span><span class="p">,</span> <span class="n">register_step</span>
<span class="nd">@register_step</span>
 <span class="k">class</span><span class="w"> </span><span class="nc">MyNewStep</span><span class="p">(</span><span class="n">BaseStep</span><span class="p">):</span>
     <span class="n">step_name</span> <span class="o">=</span> <span class="s2">"My New Step"</span>
     
     <span class="k">def</span><span class="w"> </span><span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
         <span class="c1"># Your processing logic here</span>
         <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span>
     
     <span class="k">def</span><span class="w"> </span><span class="nf">generate_diagnostics</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
         <span class="c1"># Your diagnostics logic here</span>
         <span class="k">pass</span>
</pre></div>
</div>
<p>There are already default methods for generating common diagnostics, such as time series plots and scatter plots. See the <a class="reference external" href="https://noc-obg-autonomy.github.io/toolbox/api/toolbox/utils/diagnostics/index.html">utils.diagnostics documentation</a> for more information.</p>
</li>
<li><p>Add the step to your Pipelines Config file, using the <code class="docutils literal notranslate"><span class="pre">step_name</span></code> you defined in step 3.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="w"> </span><span class="c1"># Pipeline Configuration</span>
<span class="w"> </span><span class="nt">pipeline</span><span class="p">:</span>
<span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">"My</span><span class="nv"> </span><span class="s">Pipeline"</span>
<span class="w"> </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="s">"A</span><span class="nv"> </span><span class="s">pipeline</span><span class="nv"> </span><span class="s">for</span><span class="nv"> </span><span class="s">demonstration</span><span class="nv"> </span><span class="s">purposes"</span>
<span class="w"> </span><span class="c1"># Steps in the pipeline</span>
<span class="w"> </span><span class="nt">steps</span><span class="p">:</span>
<span class="w"> </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">"My</span><span class="nv"> </span><span class="s">New</span><span class="nv"> </span><span class="s">Step"</span>
<span class="w">   </span><span class="nt">parameters</span><span class="p">:</span>
<span class="w">     </span><span class="nt">param1</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value1</span>
<span class="w">     </span><span class="nt">param2</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value2</span>
</pre></div>
</div>
</li>
<li><p>Any parameters defined in the <code class="docutils literal notranslate"><span class="pre">parameters</span></code> section of the config file will be passed to your step as attributes. You can access them in your <code class="docutils literal notranslate"><span class="pre">run</span></code> method using <code class="docutils literal notranslate"><span class="pre">self.param1</span></code>, <code class="docutils literal notranslate"><span class="pre">self.param2</span></code>, etc. <br/>
<strong>NOTE</strong> This is handled automatically by the <code class="docutils literal notranslate"><span class="pre">BaseStep</span></code> class. More information can be found in the <a class="reference external" href="https://noc-obg-autonomy.github.io/toolbox/_modules/toolbox/steps.html">BaseStep documentation</a>.</p></li>
</ol>
</section>
</section>
<div class="clearer"></div>
</div>
</div>
</div>
<div aria-label="Main" class="sphinxsidebar" role="navigation">
<div class="sphinxsidebarwrapper">
<div>
<h3><a href="index.html">Table of Contents</a></h3>
<ul>
<li><a class="reference internal" href="#">Developer Guide</a><ul>
<li><a class="reference internal" href="#what-is-a-step">What is a “step”?</a></li>
<li><a class="reference internal" href="#how-to-add-a-new-step">How to add a new step</a></li>
</ul>
</li>
</ul>
</div>
<div>
<h4>Previous topic</h4>
<p class="topless"><a href="index.html" title="previous chapter">Toolbox Documentation</a></p>
</div>
<div aria-label="source link" role="note">
<h3>This Page</h3>
<ul class="this-page-menu">
<li><a href="_sources/developer_guide.md.txt" rel="nofollow">Show Source</a></li>
</ul>
</div>
<search id="searchbox" role="search" style="display: none">
<h3 id="searchlabel">Quick search</h3>
<div class="searchformwrapper">
<form action="search.html" class="search" method="get">
<input aria-labelledby="searchlabel" autocapitalize="off" autocomplete="off" autocorrect="off" name="q" spellcheck="false" type="text"/>
<input type="submit" value="Go"/>
</form>
</div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
</div>
</div>
<div class="clearer"></div>
</div>
<div aria-label="Related" class="related" role="navigation">
<h3>Navigation</h3>
<ul>
<li class="right" style="margin-right: 10px">
<a href="genindex.html" title="General Index">index</a></li>
<li class="right">
<a href="index.html" title="Toolbox Documentation">previous</a> |</li>
<li class="nav-item nav-item-0"><a href="index.html">Toolbox 0.0.0a documentation</a> »</li>
<li class="nav-item nav-item-this"><a href="">Developer Guide</a></li>
</ul>
</div>
<div class="footer" role="contentinfo">
    © Copyright 2025, Adam Ward, National Oceanography Centre.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.1.3.
    </div>
</body>
</html>