<!DOCTYPE html>

<html lang="en" data-content_root="../../../../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>toolbox.steps.custom.find_profiles &#8212; Toolbox 0.0.0a documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../../../_static/pygments.css?v=d75fae25" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/groundwork.css?v=594d7a89" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/graphviz.css?v=4ae1632d" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/sphinx-codeautolink.css?v=b2176991" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/sphinx-design.min.css?v=95c83b7e" />
    <script src="../../../../../_static/documentation_options.js?v=e8454e50"></script>
    <script src="../../../../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../../../_static/copybutton.js?v=df1a032d"></script>
    <script src="../../../../../_static/design-tabs.js?v=f930bc37"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="canonical" href="https://noc-obg-autonomy.github.io/toolbox/api/toolbox/steps/custom/find_profiles/index.html" />
    <link rel="index" title="Index" href="../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../search.html" />
    <link rel="next" title="toolbox.steps.custom.gen_data" href="../gen_data/index.html" />
    <link rel="prev" title="toolbox.steps.custom.export" href="../export/index.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../gen_data/index.html" title="toolbox.steps.custom.gen_data"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../export/index.html" title="toolbox.steps.custom.export"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../../../index.html">Toolbox 0.0.0a documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../../../index.html" >API Reference</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../../../index.html" >toolbox</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../../index.html" >toolbox.steps</a> &#187;</li>
          <li class="nav-item nav-item-4"><a href="../index.html" accesskey="U">toolbox.steps.custom</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">toolbox.steps.custom.find_profiles</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="module-toolbox.steps.custom.find_profiles">
<span id="toolbox-steps-custom-find-profiles"></span><h1>toolbox.steps.custom.find_profiles<a class="headerlink" href="#module-toolbox.steps.custom.find_profiles" title="Link to this heading">¶</a></h1>
<p>Class definition for exporting data steps.</p>
<section id="classes">
<h2>Classes<a class="headerlink" href="#classes" title="Link to this heading">¶</a></h2>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#toolbox.steps.custom.find_profiles.FindProfilesStep" title="toolbox.steps.custom.find_profiles.FindProfilesStep"><code class="xref py py-obj docutils literal notranslate"><span class="pre">FindProfilesStep</span></code></a></p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
</section>
<section id="functions">
<h2>Functions<a class="headerlink" href="#functions" title="Link to this heading">¶</a></h2>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#toolbox.steps.custom.find_profiles.find_profiles" title="toolbox.steps.custom.find_profiles.find_profiles"><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_profiles</span></code></a>(df, gradient_thresholds[, ...])</p></td>
<td><p>Identifies vertical profiles in oceanographic or similar data by analyzing depth gradients over time.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="module-contents">
<h2>Module Contents<a class="headerlink" href="#module-contents" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="toolbox.steps.custom.find_profiles.find_profiles">
<span class="sig-prename descclassname"><span class="pre">toolbox.steps.custom.find_profiles.</span></span><span class="sig-name descname"><span class="pre">find_profiles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gradient_thresholds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><span class="pre">list</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter_win_sizes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['20s',</span> <span class="pre">'10s']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'TIME'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'DEPTH'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/toolbox/steps/custom/find_profiles.html#find_profiles"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#toolbox.steps.custom.find_profiles.find_profiles" title="Link to this definition">¶</a></dt>
<dd><p>Identifies vertical profiles in oceanographic or similar data by analyzing depth gradients over time.</p>
<p>This function processes depth-time data to identify periods where an instrument is performing
vertical profiling based on gradient thresholds. It handles data interpolation, calculates vertical
velocities, applies median filtering, and assigns unique profile numbers to identified profiles.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>polars.DataFrame</em>) – Input dataframe containing time and depth measurements</p></li>
<li><p><strong>gradient_thresholds</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><em>list</em></a>) – Two-element list [positive_threshold, negative_threshold] defining the vertical velocity
range (in meters/second) that is NOT considered part of a profile. typical values are around [0.02, -0.02]</p></li>
<li><p><strong>filter_win_sizes</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><em>list</em></a><em>, </em><em>default=</em><em> [</em><em>'20s'</em><em>, </em><em>'10s'</em><em>]</em>) – Window sizes for the compound filter applied to gradient calculations, in Polars duration format.
index 0 controls the rolling median window size and index 1 controls the rolling mean window size.</p></li>
<li><p><strong>time_col</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>, </em><em>default='TIME'</em>) – Name of the column containing timestamp data</p></li>
<li><p><strong>depth_col</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>, </em><em>default='DEPTH'</em>) – Name of the column containing depth measurements</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dataframe with additional columns:
- ‘dt’: Time difference between consecutive points (seconds)
- ‘dz’: Depth difference between consecutive points (meters)
- ‘grad’: Vertical velocity (dz/dt, meters/second)
- ‘smooth_grad’: Median-filtered vertical velocity
- ‘is_profile’: Boolean indicating if a point belongs to a profile
- ‘profile_num’: Unique identifier for each identified profile (0 for non-profile points)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>polars.DataFrame</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The function considers a point part of a profile when its smoothed vertical velocity
falls outside the range specified by gradient_thresholds.</p></li>
<li><p>‘depth_col’ does not strictly have to be a depth measurement, any variable which follows
the profile shape (such as pressure) could also be used, though this would change the units
and interpretation of grad.</p></li>
</ul>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="toolbox.steps.custom.find_profiles.FindProfilesStep">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">toolbox.steps.custom.find_profiles.</span></span><span class="sig-name descname"><span class="pre">FindProfilesStep</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diagnostics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">context</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/toolbox/steps/custom/find_profiles.html#FindProfilesStep"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#toolbox.steps.custom.find_profiles.FindProfilesStep" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="../../base_step/index.html#toolbox.steps.base_step.BaseStep" title="toolbox.steps.base_step.BaseStep"><code class="xref py py-obj docutils literal notranslate"><span class="pre">toolbox.steps.base_step.BaseStep</span></code></a></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="toolbox.steps.custom.find_profiles.FindProfilesStep.step_name">
<span class="sig-name descname"><span class="pre">step_name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'Find</span> <span class="pre">Profiles'</span></em><a class="reference internal" href="../../../../../_modules/toolbox/steps/custom/find_profiles.html#FindProfilesStep.step_name"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#toolbox.steps.custom.find_profiles.FindProfilesStep.step_name" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="toolbox.steps.custom.find_profiles.FindProfilesStep.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/toolbox/steps/custom/find_profiles.html#FindProfilesStep.run"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#toolbox.steps.custom.find_profiles.FindProfilesStep.run" title="Link to this definition">¶</a></dt>
<dd><p>To be implemented by subclasses</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="toolbox.steps.custom.find_profiles.FindProfilesStep.generate_diagnostics">
<span class="sig-name descname"><span class="pre">generate_diagnostics</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/toolbox/steps/custom/find_profiles.html#FindProfilesStep.generate_diagnostics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#toolbox.steps.custom.find_profiles.FindProfilesStep.generate_diagnostics" title="Link to this definition">¶</a></dt>
<dd><p>Hook for diagnostics (optional)</p>
</dd></dl>

</dd></dl>

</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../../../../../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">toolbox.steps.custom.find_profiles</a><ul>
<li><a class="reference internal" href="#classes">Classes</a></li>
<li><a class="reference internal" href="#functions">Functions</a></li>
<li><a class="reference internal" href="#module-contents">Module Contents</a><ul>
<li><a class="reference internal" href="#toolbox.steps.custom.find_profiles.find_profiles"><code class="docutils literal notranslate"><span class="pre">find_profiles()</span></code></a></li>
<li><a class="reference internal" href="#toolbox.steps.custom.find_profiles.FindProfilesStep"><code class="docutils literal notranslate"><span class="pre">FindProfilesStep</span></code></a><ul>
<li><a class="reference internal" href="#toolbox.steps.custom.find_profiles.FindProfilesStep.step_name"><code class="docutils literal notranslate"><span class="pre">FindProfilesStep.step_name</span></code></a></li>
<li><a class="reference internal" href="#toolbox.steps.custom.find_profiles.FindProfilesStep.run"><code class="docutils literal notranslate"><span class="pre">FindProfilesStep.run()</span></code></a></li>
<li><a class="reference internal" href="#toolbox.steps.custom.find_profiles.FindProfilesStep.generate_diagnostics"><code class="docutils literal notranslate"><span class="pre">FindProfilesStep.generate_diagnostics()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="../export/index.html"
                          title="previous chapter">toolbox.steps.custom.export</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="../gen_data/index.html"
                          title="next chapter">toolbox.steps.custom.gen_data</a></p>
  </div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../gen_data/index.html" title="toolbox.steps.custom.gen_data"
             >next</a> |</li>
        <li class="right" >
          <a href="../export/index.html" title="toolbox.steps.custom.export"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../../../index.html">Toolbox 0.0.0a documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../../../index.html" >API Reference</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../../../index.html" >toolbox</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../../index.html" >toolbox.steps</a> &#187;</li>
          <li class="nav-item nav-item-4"><a href="../index.html" >toolbox.steps.custom</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">toolbox.steps.custom.find_profiles</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright 2025, Adam Ward, National Oceanography Centre.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.1.3.
    </div>
  </body>
</html>